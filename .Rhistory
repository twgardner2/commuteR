commute %>% filter(!is.na(arriveHome)) %>% group_by(trainNum_Evening) %>% summarize(result = mean(arriveHome))
# Density plot of arrive home by evening train
tempPlotData <- commute %>%
filter(!is.na(arriveHome)) %>%
select(trainNum_Evening, arriveHome) %>%
gather()
plot <- data.frame(tempPlotData) %>% ggplot(aes(x=arriveHome, fill=trainNum_Evening))
plot + geom_density(alpha=0.5)
plot + geom_density(alpha=0.5)
commute
View(commute)
# Density plot of arrive home by evening train
tempPlotData <- commute %>%
filter(!is.na(arriveHome)) %>%
select(trainNum_Evening, arriveHome) %>%
gather()
# Density plot of arrive home by evening train
tempPlotData <- commute %>%
filter(!is.na(arriveHome)) %>%
select(trainNum_Evening, arriveHome)
plot <- data.frame(tempPlotData) %>% ggplot(aes(x=arriveHome, fill=trainNum_Evening))
plot + geom_density(alpha=0.5)
# Table of typicial arrival home based on train
commute %>% filter(!is.na(arriveHome)) %>% group_by(trainNum_Evening) %>% summarize(result = mean(arriveHome))
View(commute)
latetrain <- commute %>% filter(trainNum_Evening=="329")
View(latetrain)
# Density plot of arrive home by evening train
tempPlotData <- commute %>%
filter(!is.na(arriveHome)) %>%
select(trainNum_Evening, arriveHome)
plot <- data.frame(tempPlotData) %>% ggplot(aes(x=arriveHome, fill=trainNum_Evening))
plot + geom_density(alpha=0.5)
# Density plot of arrive home by evening train
tempPlotData <- commute %>%
filter(!is.na(arriveHome)) %>%
select(trainNum_Evening, arriveHome)
View(tempPlotData)
View(commute)
library("googlesheets")
library("ggplot2")
suppressPackageStartupMessages(library("dplyr"))
library("tidyverse")
library("lubridate")
# Load 2018 Tracker, Daily Times sheet
tracker <- gs_url(
x = "https://docs.google.com/spreadsheets/d/11JAREyf0pTdR0d0b_DXDjOsI8P5L2WH_P31ALfqtSXI/edit?usp=sharing",
lookup = TRUE
)
# Read 'Daily Times' tab (ws = 2)
commuteRaw <- gs_read(
ss = tracker,
ws = 2,
range = cell_cols('A:T'),
col_types = cols(date                   = col_date(format = "%y-%m-%d"),
alarm                  = 't',
departHouse            = 't',
arrivePlatform_Morning = 't',
route_Morning          = 'c',
mpg_Morning            = 'd',
score_Morning          = 'i',
trainNum_Morning       = 'c',
trainDepart_Morning    = 't',
trainArrive_Morning    = 't',
arriveWork             = 't',
departWork             = 't',
trainNum_Evening       = 'c',
arrivePlatform_Evening = 't',
trainDepart_Evening    = 't',
carDepart_Evening      = 't',
arriveHome             = "t",
route_Evening          = 'c',
mpg_Evening            = 'd',
score_Evening          = 'i')
)
View(commuteRaw)
# Remove future rows
commuteRaw <- commuteRaw %>% filter(date < Sys.Date())
# Convert times to POSIXct ----
commute <- commuteRaw %>% mutate(alarm               = as.POSIXct(alarm, format="%H:%M"),
arriveHome             = as.POSIXct(arriveHome, format="%H:%M"),
arrivePlatform_Morning = as.POSIXct(arrivePlatform_Morning, format="%H:%M"),
arriveWork             = as.POSIXct(arriveWork, format="%H:%M"),
carDepart_Evening      = as.POSIXct(carDepart_Evening, format="%H:%M"),
departHouse            = as.POSIXct(departHouse, format="%H:%M"),
departWork             = as.POSIXct(departWork, format="%H:%M"),
arrivePlatform_Evening = as.POSIXct(arrivePlatform_Evening, format="%H:%M"),
trainArrive_Morning    = as.POSIXct(trainArrive_Morning, format="%H:%M"),
trainDepart_Evening    = as.POSIXct(trainDepart_Evening, format="%H:%M"),
trainDepart_Morning    = as.POSIXct(trainDepart_Morning, format="%H:%M"))
commute <- commute %>% mutate(totalCommute_Morning = arriveWork - departHouse,
totalCommute_Evening = arriveHome - departWork,
totalGoneForDay      = arriveHome - departHouse)
View(commute)
tempPlotData
# Typical arrival home for given evening train
tempPlotData <- commute %>% filter(trainNum_Evening == "331") %>%
select(arriveHome) %>%
gather()
# Density plot of arrive home by evening train
tempPlotData <- commute %>%
filter(!is.na(arriveHome)) %>%
select(trainNum_Evening, arriveHome)
plot <- data.frame(tempPlotData) %>% ggplot(aes(x=arriveHome, fill=trainNum_Evening))
plot + geom_density(alpha=0.5)
tempPlotData
# Density plot of arrive home by evening train
tempPlotData <- commute %>%
filter(!is.na(arriveHome)) %>% filter(!trainNum_Evening=="333")
tempPlotData
tempPlotData <- commute %>%
filter(!is.na(arriveHome)) %>% filter(!trainNum_Evening=="333")
select(trainNum_Evening, arriveHome)
tempPlotData <- commute %>%
filter(!is.na(arriveHome)) %>% filter(!trainNum_Evening=="333")
select(trainNum_Evening, arriveHome)
# Density plot of arrive home by evening train
tempPlotData <- commute %>%
filter(!is.na(arriveHome)) %>% filter(!trainNum_Evening=="333") %>%
select(trainNum_Evening, arriveHome)
tempPlotData
plot <- data.frame(tempPlotData) %>% ggplot(aes(x=arriveHome, fill=trainNum_Evening))
plot + geom_density(alpha=0.5)
plot + geom_histogram()
# Density plot of arrive home by evening train
tempPlotData <- commute %>%
filter(!is.na(arriveHome)) %>% #filter(!trainNum_Evening=="333") %>%
select(trainNum_Evening, arriveHome)
plot <- data.frame(tempPlotData) %>% ggplot(aes(x=arriveHome, fill=trainNum_Evening))
plot + geom_histogram()
plot + geom_density(alpha=0.5)
library("googlesheets")
library("ggplot2")
suppressPackageStartupMessages(library("dplyr"))
library("lubridate")
library("shinydashboard")
library("shiny")
library("tidyverse")
runApp()
?actionButton
runApp()
styler:::style_active_file()
styler:::style_active_file()
?renderPlot
runApp()
runApp()
styler:::style_active_file()
shiny::runApp()
??dashboardHeader
runApp()
runApp()
shiny::runApp()
styler:::style_active_file()
runApp()
styler:::style_active_file()
runApp()
commute %>% mutate(driveTimeHome = arriveHome - carDepart_Evening)
library("googlesheets")
library("ggplot2")
suppressPackageStartupMessages(library("dplyr"))
library("lubridate")
library("shinydashboard")
library("shiny")
library("tidyverse")
commute %>% mutate(driveTimeHome = arriveHome - carDepart_Evening)
commute %>% mutate(driveTimeHome = arriveHome - carDepart_Evening) %>%
select(driveTimeHome)
View(commute)
commute <- commute %>% mutate(totalCommute_Morning = arriveWork - departHouse,
totalCommute_Evening = arriveHome - departWork,
totalGoneForDay      = arriveHome - departHouse,
totalDriveHome       = arriveHome - carDepart_Evening)
commute %>% mutate(driveTimeHome = arriveHome - carDepart_Evening) %>%
select(driveTimeHome)
commute <- commute %>% mutate(totalCommute_Morning = arriveWork - departHouse,
totalCommute_Evening = arriveHome - departWork,
totalGoneForDay      = arriveHome - departHouse,
totalDriveHome       = arriveHome - carDepart_Evening)
View(commute)
commute %>% select(driveTimeHome)
averageDriveHome <- commute %>% select(totalDriveHome)
averageDriveHome <- commute %>% select(totalDriveHome) %>% mean()
commute %>% select(totalDriveHome)
averageDriveHome <- commute %>% filter(!is.na(totalDriveHome))%>% select(totalDriveHome) %>% mean()
commute$arriveHome[1]
commute$arriveHome[1] - commute$carDepart_Evening[1]
View(commute)
difftime(commute$arriveHome[1], commute$carDepart_Evening[1])
View(commute)
difftime(commute$arriveHome[1], commute$carDepart_Evening[1]) + commute$carDepart_Evening[8]
commute %>% filter(!is.na(totalDriveHome))%>% select(totalDriveHome) %>% mean()
commute %>% filter(!is.na(totalDriveHome))%>% select(totalDriveHome)
commute %>% filter(!is.na(totalDriveHome)) %>%
select(totalDriveHome) %>%
summarize(mean(totalDriveHome))
averageDriveHome <- commute %>% filter(!is.na(totalDriveHome)) %>%
select(totalDriveHome) %>%
summarize(mean(totalDriveHome))
averageDriveHome
?&
?&&
?`&`
View(commute)
commute %>% select(arriveHome) %>% sum(is.na(.))
commute %>% select(arriveHome)
commute %>% select(arriveHome) %>% is.na(.)
sum(is.na(commute$arriveHome))
commute <- commute %>% mutate(arriveHome = ifelse(is.na(arriveHome) && !is.na(carDepart_Evening),
arriveHome = carDepart_Evening + averageDriveHome,
arriveHome))
commute <- commute %>% mutate(arriveHome = ifelse((is.na(arriveHome) && !is.na(carDepart_Evening)),
arriveHome = carDepart_Evening + averageDriveHome,
arriveHome))
commute <- commute %>% mutate(arriveHome = ifelse((is.na(arriveHome) & !is.na(carDepart_Evening)),
arriveHome = carDepart_Evening + averageDriveHome,
arriveHome))
?ifelse
commute <- commute %>% mutate(arriveHome = ifelse((is.na(arriveHome) & !is.na(carDepart_Evening)),
carDepart_Evening + averageDriveHome,
arriveHome))
commute <- commute %>% mutate(arriveHome = ifelse((is.na(arriveHome) && !is.na(carDepart_Evening)),
carDepart_Evening + averageDriveHome,
arriveHome))
sum(is.na(commute$arriveHome))
View(commute)
# Convert times to POSIXct ----
commute <- commuteRaw %>% mutate(alarm               = as.POSIXct(alarm, format="%H:%M"),
arriveHome             = as.POSIXct(arriveHome, format="%H:%M"),
arrivePlatform_Morning = as.POSIXct(arrivePlatform_Morning, format="%H:%M"),
arriveWork             = as.POSIXct(arriveWork, format="%H:%M"),
carDepart_Evening      = as.POSIXct(carDepart_Evening, format="%H:%M"),
departHouse            = as.POSIXct(departHouse, format="%H:%M"),
departWork             = as.POSIXct(departWork, format="%H:%M"),
arrivePlatform_Evening = as.POSIXct(arrivePlatform_Evening, format="%H:%M"),
trainArrive_Morning    = as.POSIXct(trainArrive_Morning, format="%H:%M"),
trainDepart_Evening    = as.POSIXct(trainDepart_Evening, format="%H:%M"),
trainDepart_Morning    = as.POSIXct(trainDepart_Morning, format="%H:%M"))
commute <- commute %>% mutate(totalCommute_Morning = arriveWork - departHouse,
totalCommute_Evening = arriveHome - departWork,
totalGoneForDay      = arriveHome - departHouse,
totalDriveHome       = arriveHome - carDepart_Evening)
averageDriveHome <- commute %>% filter(!is.na(totalDriveHome)) %>%
select(totalDriveHome) %>%
summarize(mean(totalDriveHome))
averageDriveHome
View(commute)
commute <- commute %>% mutate(arriveHome = ifelse((is.na(arriveHome) && !is.na(carDepart_Evening)),
carDepart_Evening + averageDriveHome,
arriveHome))
sum(is.na(commute$arriveHome))
commute %>% select(arriveHome)
# Convert times to POSIXct ----
commute <- commuteRaw %>% mutate(alarm               = as.POSIXct(alarm, format="%H:%M"),
arriveHome             = as.POSIXct(arriveHome, format="%H:%M"),
arrivePlatform_Morning = as.POSIXct(arrivePlatform_Morning, format="%H:%M"),
arriveWork             = as.POSIXct(arriveWork, format="%H:%M"),
carDepart_Evening      = as.POSIXct(carDepart_Evening, format="%H:%M"),
departHouse            = as.POSIXct(departHouse, format="%H:%M"),
departWork             = as.POSIXct(departWork, format="%H:%M"),
arrivePlatform_Evening = as.POSIXct(arrivePlatform_Evening, format="%H:%M"),
trainArrive_Morning    = as.POSIXct(trainArrive_Morning, format="%H:%M"),
trainDepart_Evening    = as.POSIXct(trainDepart_Evening, format="%H:%M"),
trainDepart_Morning    = as.POSIXct(trainDepart_Morning, format="%H:%M"))
commute <- commute %>% mutate(totalCommute_Morning = arriveWork - departHouse,
totalCommute_Evening = arriveHome - departWork,
totalGoneForDay      = arriveHome - departHouse,
totalDriveHome       = arriveHome - carDepart_Evening)
averageDriveHome <- commute %>% filter(!is.na(totalDriveHome)) %>%
select(totalDriveHome) %>%
summarize(mean(totalDriveHome))
commute <- commute %>% mutate(arriveHome = ifelse((is.na(arriveHome) & !is.na(carDepart_Evening)),
carDepart_Evening + averageDriveHome,
arriveHome))
commute$carDepart_Evening + averageDriveHome
typeof(commute$carDepart_Evening)
typeof(averageDriveHome)
averageDriveHome <- commute %>% filter(!is.na(totalDriveHome)) %>%
select(totalDriveHome) %>%
summarize(mean(totalDriveHome)) %>%
unlist()
typeof(averageDriveHome)
commute <- commute %>% mutate(arriveHome = ifelse((is.na(arriveHome) & !is.na(carDepart_Evening)),
carDepart_Evening + averageDriveHome,
arriveHome))
sum(is.na(commute$arriveHome))
commute %>% select(arriveHome)
commute %>% filter(!is.na(arriveHome)) %>%
group_by(trainNum_Evening) %>%
summarize(result = mean(arriveHome))
tempCommute <- commute
averageDriveHome <- tempCommute %>% filter(!is.na(totalDriveHome)) %>%
select(totalDriveHome) %>%
summarize(mean(totalDriveHome)) %>%
unlist()
tempCommute <- tempCommute %>% mutate(arriveHome = ifelse((is.na(arriveHome) & !is.na(carDepart_Evening)),
carDepart_Evening + averageDriveHome,
arriveHome))
tempCommute %>% filter(!is.na(arriveHome)) %>%
group_by(trainNum_Evening) %>%
summarize(result = mean(arriveHome))
runApp()
tracker$updated
tracker$updated > Sys.Date()
# Load 2018 Tracker, Daily Times sheet
tracker <- gs_url(
x      = "https://docs.google.com/spreadsheets/d/11JAREyf0pTdR0d0b_DXDjOsI8P5L2WH_P31ALfqtSXI/edit?usp=sharing",
lookup = TRUE
)
library("googlesheets")
library("ggplot2")
suppressPackageStartupMessages(library("dplyr"))
library("lubridate")
library("shinydashboard")
library("shiny")
library("tidyverse")
# Load 2018 Tracker, Daily Times sheet
tracker <- gs_url(
x      = "https://docs.google.com/spreadsheets/d/11JAREyf0pTdR0d0b_DXDjOsI8P5L2WH_P31ALfqtSXI/edit?usp=sharing",
lookup = TRUE
)
runApp()
rsconnect::deployApp("C:\\Users\\thomas.gardner\\Documents\\R\\commuteR")
sys.time()
Sys.time()
runApp()
runApp()
runApp()
runApp()
?reactive
runApp()
rsconnect::deployApp("C:\\Users\\thomas.gardner\\Documents\\R\\commuteR")
tracker$updated
?reactivePoll
?shiny::reactivePoll
rsconnect::deployApp("C:\\Users\\thomas.gardner\\Documents\\R\\commuteR")
# Load 2018 Tracker ----
tracker <- gs_url(
x      = "https://docs.google.com/spreadsheets/d/11JAREyf0pTdR0d0b_DXDjOsI8P5L2WH_P31ALfqtSXI/edit?usp=sharing",
lookup = TRUE
)
library("googlesheets")
library("ggplot2")
suppressPackageStartupMessages(library("dplyr"))
library("lubridate")
library("shinydashboard")
library("shiny")
library("tidyverse")
# Load 2018 Tracker ----
tracker <- gs_url(
x      = "https://docs.google.com/spreadsheets/d/11JAREyf0pTdR0d0b_DXDjOsI8P5L2WH_P31ALfqtSXI/edit?usp=sharing",
lookup = TRUE
)
shiny::runApp()
runApp()
runApp()
install.packages("DT")
runApp()
?DT::formatDate
runApp()
runApp()
View(commute)
# Load 2018 Tracker ----
tracker <- gs_url(
x      = "https://docs.google.com/spreadsheets/d/11JAREyf0pTdR0d0b_DXDjOsI8P5L2WH_P31ALfqtSXI/edit?usp=sharing",
lookup = TRUE
)
# Read 'commute' tab (ws = 2) ----
commuteRaw <- gs_read(
ss = tracker,
ws = 2,
range = cell_cols('A:T'),
col_types = cols(date                   = col_date(format = "%y-%m-%d"),
alarm                  = 't',
departHouse            = 't',
arrivePlatform_Morning = 't',
route_Morning          = 'c',
mpg_Morning            = 'd',
score_Morning          = 'i',
trainNum_Morning       = 'c',
trainDepart_Morning    = 't',
trainArrive_Morning    = 't',
arriveWork             = 't',
departWork             = 't',
trainNum_Evening       = 'c',
arrivePlatform_Evening = 't',
trainDepart_Evening    = 't',
carDepart_Evening      = 't',
arriveHome             = "t",
route_Evening          = 'c',
mpg_Evening            = 'd',
score_Evening          = 'i')
)
# Remove future rows ----
commuteRaw <- commuteRaw %>% filter(date < Sys.Date())
View(commuteRaw)
# Read 'commute' tab (ws = 2) ----
commuteRaw <- gs_read(
ss = tracker,
ws = 2,
range = cell_cols('A:T'),
col_types = cols(date                   = col_date(format = "%y-%m-%d"),
alarm                  = 't',
departHouse            = 't',
arrivePlatform_Morning = 't',
route_Morning          = 'c',
mpg_Morning            = 'd',
score_Morning          = 'i',
trainNum_Morning       = 'c',
trainDepart_Morning    = 't',
trainArrive_Morning    = 't',
arriveWork             = 't',
departWork             = 't',
trainNum_Evening       = 'c',
arrivePlatform_Evening = 't',
trainDepart_Evening    = 't',
carDepart_Evening      = 't',
arriveHome             = "t",
route_Evening          = 'c',
mpg_Evening            = 'd',
score_Evening          = 'i')
)
# Remove future rows ----
commuteRaw <- commuteRaw %>% filter(date <= Sys.Date())
View(commuteRaw)
# Convert times to POSIXct ----
commute <- commuteRaw %>% mutate(alarm               = as.POSIXct(alarm, format="%H:%M"),
arriveHome             = as.POSIXct(arriveHome, format="%H:%M"),
arrivePlatform_Morning = as.POSIXct(arrivePlatform_Morning, format="%H:%M"),
arriveWork             = as.POSIXct(arriveWork, format="%H:%M"),
carDepart_Evening      = as.POSIXct(carDepart_Evening, format="%H:%M"),
departHouse            = as.POSIXct(departHouse, format="%H:%M"),
departWork             = as.POSIXct(departWork, format="%H:%M"),
arrivePlatform_Evening = as.POSIXct(arrivePlatform_Evening, format="%H:%M"),
trainArrive_Morning    = as.POSIXct(trainArrive_Morning, format="%H:%M"),
trainDepart_Evening    = as.POSIXct(trainDepart_Evening, format="%H:%M"),
trainDepart_Morning    = as.POSIXct(trainDepart_Morning, format="%H:%M"))
# Compute fields ----
commute <- commute %>% mutate(totalCommute_Morning = arriveWork - departHouse,
totalCommute_Evening = arriveHome - departWork,
totalGoneForDay      = arriveHome - departHouse,
totalDriveHome       = arriveHome - carDepart_Evening)
runApp()
?as.POSIXct
runApp()
runApp()
Sys.timezone()
runApp()
runApp()
commute %>% filter(!is.na(totalDriveHome))
commute %>% filter(!is.na(totalDriveHome)) %>%
select(totalDriveHome)
commute %>% filter(!is.na(totalDriveHome)) %>%
select(totalDriveHome) %>%
summarize(mean(totalDriveHome))
commute %>% filter(!is.na(totalDriveHome)) %>%
select(totalDriveHome) %>%
summarize(mean(totalDriveHome)) %>%
unlist()
commute %>% filter(!is.na(totalDriveHome)) %>%
select(totalDriveHome) %>%
summarize(mean(totalDriveHome)) %>%
unlist() %>% as.POSIXct()
?as.POSIXct
commute %>% filter(!is.na(totalDriveHome)) %>%
select(totalDriveHome) %>%
summarize(mean(totalDriveHome)) %>%
unlist() %>% as.POSIXct(origin=0)
commute %>% filter(!is.na(totalDriveHome)) %>%
select(totalDriveHome) %>%
summarize(mean(totalDriveHome)) %>%
unlist() %>% as.POSIXct(origin="1970-01-01 00:00:00")
commute %>% filter(!is.na(totalDriveHome)) %>%
select(totalDriveHome) %>%
summarize(mean(totalDriveHome)) %>%
unlist()
commute %>% filter(!is.na(totalDriveHome)) %>%
select(totalDriveHome) %>%
summarize(mean(totalDriveHome)) %>%
unlist() * 60
runApp()
commute %>% filter(!is.na(totalDriveHome)) %>%
select(totalDriveHome) %>%
summarize(mean(totalDriveHome)) %>%
unlist() * 60
commute %>% filter(!is.na(totalDriveHome)) %>%
select(totalDriveHome) %>%
summarize(mean(totalDriveHome)) %>%
unlist()
runApp()
averageDriveHome <- commute %>% filter(!is.na(totalDriveHome)) %>%
select(totalDriveHome) %>%
summarize(mean(totalDriveHome)) %>%
unlist() * 60 #%>% as.POSIXct(origin="1970-01-01 00:00:00")
averageDriveHome <- commute %>% filter(!is.na(totalDriveHome)) %>%
select(totalDriveHome) %>%
summarize(mean(totalDriveHome)) %>%
unlist() * 60 %>%
unname()
?unname
averageDriveHome
unname(averageDriveHome)
runApp()
commute$carDepart_Evening[1]
commute$carDepart_Evening[1] + averageDriveHome
runApp()
data() %>% filter(!is.na(arriveHome)) %>%
group_by(trainNum_Evening) %>%
summarize(result = mean(arriveHome))
runApp()
averageDriveHome
runApp()
?strptime
